<!DOCTYPE html>
<html lang="es">
<head> 
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Promedio Ponderado</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="dashboard-styles.css">
  <link rel="stylesheet" href="launcher-cards.css">
  <link rel="stylesheet" href="escala-notas-responsive.css">
  <link rel="stylesheet" href="matematicas-rapidas.css">

  <link rel="stylesheet" href="animated-backgrounds.css">
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="theme-dark">
  <!-- Botón de Usuario Global - Siempre visible -->
  <div class="global-user-controls">
    <button id="user-btn" class="user-btn">
      <span class="user-icon">👤</span>
      <span class="user-text">Cuenta</span>
    </button>
  </div>

  <!-- Botón de Créditos en esquina superior izquierda -->
  <button id="credits-btn" class="credits-btn-fixed" role="button" title="Créditos y Licencias">
    i
  </button>

  <!-- Botón para desplegar selector de temas -->
  <button id="toggle-themes-btn" class="toggle-themes-btn" role="button" title="Cambiar Tema">
    🎨
  </button>

  <!-- Selector de temas vertical debajo del botón de créditos -->
  <div class="vertical-theme-selector" id="vertical-theme-selector">
    <button class="vertical-theme-btn" data-theme="theme-dark" title="Dark">🌙</button>
    <button class="vertical-theme-btn" data-theme="theme-light" title="Claro">🌞</button>
    <button class="vertical-theme-btn" data-theme="theme-rosa" title="Rosa">🌸</button>
    
    <button class="vertical-theme-btn" data-theme="theme-neon" title="Neón">🎇</button>
  </div>

  <!-- Dashboard Principal -->
  <div id="dashboard-main" class="dashboard-main">
    <!-- Header del Dashboard -->
    <header class="dashboard-header">
      <div class="header-content">
          <h1 class="dashboard-title">PROFENINJA</h1>
        <p class="dashboard-subtitle">Accede a todas tus herramientas favoritas en un lugar</p>
      </div>
      <!-- Botón de Usuario movido fuera del header -->
      <!-- Barra de búsqueda -->
      <div class="search-container">
        <input type="text" id="search-tools" class="search-input" placeholder="Buscar herramientas...">
        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="M21 21l-4.35-4.35"></path>
    </svg>
    </div>
      
      <!-- Filtros de categoría -->
      <div class="category-filters">
        <button class="filter-btn active" data-category="all">Todas</button>
        <button class="filter-btn" data-category="calculadora">Calculadora</button>
        <button class="filter-btn" data-category="herramientas">Herramientas</button>
        <button class="filter-btn" data-category="juegos">Juegos</button>
        <button class="filter-btn" data-category="configuracion">Configuración</button>
      </div>
    </header>
    
    <!-- Grid de Herramientas -->
    <main class="tools-grid">
    </main>
    
    <!-- Nuevo Launcher de Aplicaciones -->
    <div class="launcher-container">
      <div class="launcher-apps-grid">
      <!-- Calculadora Principal -->
        <div class="launcher-app-item" data-app="calculadora" data-category="calculadora">
          <a href="#" class="launcher-app-link" data-tool="calculadora">
            <div class="launcher-app-content">
            <div class="launcher-app-icon">🧮</div>
            <div class="launcher-app-title">Calculadora</div>
            <div class="launcher-app-description">Promedio Ponderado</div>
            <div class="launcher-app-category">Calculadora</div>
            </div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

      <!-- Escala de Notas -->
        <div class="launcher-app-item" data-app="conversor" data-category="calculadora">
          <a href="#" class="launcher-app-link" data-tool="escala">
            <div class="launcher-app-icon">🔄</div>
            <div class="launcher-app-title">Escala de Notas</div>
            <div class="launcher-app-description">Conversión de Escalas</div>
            <div class="launcher-app-category">Calculadora</div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

      <!-- Múltiples Promedios -->
        <div class="launcher-app-item" data-app="multi" data-category="calculadora">
          <a href="#" class="launcher-app-link" data-tool="multi">
            <div class="launcher-app-icon">📊</div>
            <div class="launcher-app-title">Múltiples Promedios</div>
            <div class="launcher-app-description">Gestión de Cursos</div>
            <div class="launcher-app-category">Calculadora</div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>



      <!-- Contador de Palabras -->
        <div class="launcher-app-item" data-app="contador" data-category="herramientas">
          <a href="#" class="launcher-app-link" data-tool="word-counter">
            <div class="launcher-app-icon">📝</div>
            <div class="launcher-app-title">Contador de Palabras</div>
            <div class="launcher-app-description">Análisis de Texto</div>
            <div class="launcher-app-category">Herramientas</div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

      <!-- Creador de Rúbricas -->
        <div class="launcher-app-item" data-app="creador-rubricas" data-category="herramientas">
          <a href="creador-rubricas.html" class="launcher-app-link" data-tool="creador-rubricas">
            <div class="launcher-app-content">
            <div class="launcher-app-icon">📋</div>
            <div class="launcher-app-title">Creador de Rúbricas</div>
            <div class="launcher-app-description">Crear y Editar Rúbricas</div>
            <div class="launcher-app-category">Herramientas</div>
            </div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

      <!-- Evalúa con Rúbrica -->
        <div class="launcher-app-item" data-app="evalua-rubricas" data-category="herramientas">
          <a href="evalua-rubricas.html" class="launcher-app-link" data-tool="evalua-rubricas">
            <div class="launcher-app-content">
            <div class="launcher-app-icon">✅</div>
            <div class="launcher-app-title">Evalúa con Rúbrica</div>
            <div class="launcher-app-description">Evaluación de Estudiantes</div>
            <div class="launcher-app-category">Herramientas</div>
            </div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

        <!-- Grupos Aleatorios -->
        <div class="launcher-app-item" data-app="grupos" data-category="herramientas">
          <a href="#" class="launcher-app-link" data-tool="grupos-aleatorios">
            <div class="launcher-app-icon">👥</div>
            <div class="launcher-app-title">Grupos Aleatorios</div>
            <div class="launcher-app-description">Organización Automática</div>
            <div class="launcher-app-category">Herramientas</div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>
    
      <!-- Gestión de Estudiantes -->
        <div class="launcher-app-item" data-app="estudiantes" data-category="configuracion">
          <a href="#" class="launcher-app-link" data-tool="config">
            <div class="launcher-app-icon">👨‍🎓</div>
            <div class="launcher-app-title">Gestión de Estudiantes</div>
            <div class="launcher-app-description">Administración</div>
            <div class="launcher-app-category">Configuración</div>
            <div class="launcher-app-bg"></div>
          </a>
        </div>

        <!-- SIMCE -->
        <div class="launcher-app-item" data-app="simce" data-category="herramientas">
          <a href="simce.html" class="launcher-app-link" data-tool="simce">
            <div class="launcher-app-content">
            <div class="launcher-app-icon">📊</div>
            <div class="launcher-app-title">SIMCE</div>
            <div class="launcher-app-description">Evaluación SIMCE</div>
            <div class="launcher-app-category">Herramientas</div>
            </div>
            <div class="launcher-app-bg"></div>
          </a>
        </div>

        <!-- PAES -->
        <div class="launcher-app-item" data-app="paes" data-category="herramientas">
          <a href="paes.html" class="launcher-app-link" data-tool="paes">
            <div class="launcher-app-content">
            <div class="launcher-app-icon">📋</div>
            <div class="launcher-app-title">PAES</div>
            <div class="launcher-app-description">Evaluación PAES</div>
            <div class="launcher-app-category">Herramientas</div>
            </div>
            <div class="launcher-app-bg"></div>
          </a>
        </div>

        <!-- Matemáticas Rápidas -->
        <div class="launcher-app-item" data-app="matematicas-rapidas" data-category="juegos">
          <a href="#" class="launcher-app-link" data-tool="matematicas-rapidas">
            <div class="launcher-app-icon">🧠</div>
            <div class="launcher-app-title">Matemáticas Rápidas</div>
            <div class="launcher-app-description">Suma Mental Rápida</div>
            <div class="launcher-app-category">Juegos</div>
            <div class="launcher-app-bg"></div>
          </a>
      </div>

        <!-- Preguntas Rápidas -->
        <div class="launcher-app-item" data-app="preguntas-rapidas" data-category="herramientas">
          <a href="preguntas-rapidas.html" class="launcher-app-link" data-tool="preguntas-rapidas">
            <div class="launcher-app-icon">❓</div>
            <div class="launcher-app-title">Preguntas Rápidas</div>
            <div class="launcher-app-description">Cuestionarios Interactivos</div>
            <div class="launcher-app-category">Herramientas</div>
            <div class="launcher-app-bg"></div>
          </a>
        </div>

        <!-- Temas Visuales - ELIMINADO -->
    </div>
  </div>

  <!-- Sistema de fondos bg-wrap eliminado - ahora se usa animated-backgrounds.js -->
  </div>

  <!-- Panel de Calculadora de Promedio Ponderado -->
  <div class="container" id="calc-panel" style="display: none;">
      <h1>Calculadora de Promedio Ponderado</h1>
      
      <!-- Panel superior con plantillas -->
      <div class="top-panel">
        <select id="tplSelect"><option value="">Seleccionar ramo</option></select>
        <button id="show-ramo-panel" class="add-ramo-btn">+ Agregar Ramo</button>
      </div>

      <!-- Panel de guardado de ramos -->
      <div class="template-controls" id="ramo-panel" style="display:none;">
        <input type="text" id="tplName" placeholder="Nombre de ramo">
        <div class="template-buttons">
          <button id="delTpl">Eliminar</button>
          <button id="saveTpl">Guardar</button>
        </div>
        <button id="hide-ramo-panel">Cerrar</button>
      </div>

      <div class="main">
        <!-- Panel de notas -->
        <div class="grades-panel">


          <!-- Panel normal de notas -->
          <div id="notas-normales">
            <div class="controls">
              <button class="btn-add" onclick="addRow()">+</button>
              <button class="btn-remove" onclick="removeRow()">-</button>
              <button class="btn-reset" onclick="resetAll()">↻</button>
            </div>
            
            <div class="rows-wrapper">
              <div class="labels">
                <div>Notas</div>
                <div>Ponderaciones</div>
              </div>
              <div id="rows-container"></div>
            </div>
          </div>
        </div>

        <!-- Panel de resultados -->
        <div class="results-panel" style="display: flex; flex-direction: column; gap: 15px;">
          <div id="result-panel" class="result-panel red" style="display: block; opacity: 1; visibility: visible;">
            <div id="result-title">Promedio ponderado</div>
            <div id="result-value">0.00</div>
            <div id="result-status">Reprobado</div>
          </div>
          
          <div id="needed-panel" class="result-panel" style="display: none; opacity: 1; visibility: visible;">
            <div id="needed-title">Nota mínima necesaria</div>
            <div id="needed-value">-</div>
          </div>

          <!-- Botón calcular -->
          <button id="calcBtn" onclick="calculateAverage()" style="display: block; opacity: 1; visibility: visible;">Calcular Promedio</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts originales -->
  <script src="script.js"></script>
  <script src="animated-backgrounds.js"></script>
  <script src="main.js"></script>
  <script src="escala-notas-mobile.js"></script>
  <script src="multi-panel-functions.js"></script>
  <script src="rubricas.js"></script>
  <script src="rubrica-config.js"></script>

  <script src="matematicas-rapidas.js"></script>
  

  
  <!-- Módulos de Supabase -->
  <script src="supabase-config.js"></script>
  <script src="supabase-adapter.js"></script>
  <script src="auth-manager.js"></script>
  <script src="supabase-init.js"></script>
  <div id="escala-panel" style="display:none;max-width:900px;margin:40px auto 0 auto;">
    <div class="container" style="background: var(--card-bg);">
      <h2>Generador de Escala de Notas</h2>
      
      <!-- Panel de edición -->
      <div class="inputs">
        <div class="input-group">
          <label for="puntajeMax">Puntaje máximo</label>
          <input type="number" id="puntajeMax" min="1" value="100">
        </div>
        <div class="input-group">
          <label for="exigencia">Exigencia (%)</label>
          <input type="number" id="exigencia" min="0" max="100" value="60">
        </div>
        <div class="input-group">
          <label for="notaMin">Nota mínima</label>
          <input type="number" id="notaMin" step="0.1" min="1" max="10" value="1.0">
        </div>
        <div class="input-group">
          <label for="notaMax">Nota máxima</label>
          <input type="number" id="notaMax" step="0.1" min="1" max="10" value="7.0">
        </div>
        <div class="input-group">
          <label for="notaAprob">Nota de aprobación</label>
          <input type="number" id="notaAprob" step="0.1" min="1" max="10" value="4.0">
        </div>
      </div>

      <!-- Botones de modo -->
      <div class="tabla-controls">
        <button class="tabla-mode-btn active" data-mode="normal">Normal</button>
      </div>

      <!-- Conversor de puntaje a nota -->
      <div class="conversor-container">
        <div class="conversor-title">Conversor de Puntaje a Nota</div>
        <div class="conversor-inputs">
          <div class="conversor-group">
            <label class="conversor-label">Puntaje</label>
            <input type="number" class="conversor-input" id="puntaje-input" placeholder="Ingrese puntaje">
          </div>
          <div class="conversor-group">
            <label class="conversor-label">Nota</label>
            <div class="conversor-result" id="nota-result">-.-</div>
          </div>
        </div>
      </div>



      <!-- Control de visibilidad de columnas -->
      <div class="columnas-control">
        <button id="toggle-columnas" class="tabla-mode-btn">
          <span class="columnas-icon">📊</span>
          <span class="columnas-texto">Ocultar tabla</span>
        </button>
      </div>

      <!-- Tabla de escala -->
      <div id="tablaEscala" class="tabla-multi"></div>
    </div>
  </div>

  <div id="multi-panel" style="display:none;">
    <div class="container">
      <h1>Calculadora de Notas Parciales</h1>
      
      <!-- Selector de cursos -->
      <div class="curso-selection">
        <div class="curso-controls">
          <select id="curso-select-multi" class="curso-select-multi">
            <option value="">Seleccionar Curso</option>
          </select>
          <button id="btn-cargar-curso-multi" type="button">📚 Cargar Curso</button>
          <button id="btn-limpiar-todo-multi" type="button">🗑️ Limpiar Todo</button>
        </div>
      </div>
      
      <div class="multi-controls">
        <button class="btn-add-section" onclick="addSection()"> Agregar Estudiante</button>
        <button class="btn-remove-section" onclick="removeSection()">Eliminar Estudiante</button>
        <input type="file" id="input-excel-multi" accept=".xls,.xlsx" style="display:none" />
        <button id="btn-cargar-excel-multi" type="button">Cargar Curso (Excel)</button>
        <button id="btn-descargar-excel-multi" type="button">Descargar Excel</button>
      </div>

      <!-- Controles de notas y porcentajes -->
      <div class="notas-control">
        <div class="control-group">
          <input type="number" id="cantidad-notas" min="1" value="1" placeholder="Cantidad de notas">
          <button onclick="aplicarCantidadNotas()" class="btn-aplicar">Número de notas</button>
        </div>
        <div class="control-group">
          <input type="number" id="porcentaje-comun" min="1" max="100" value="100" placeholder="Porcentaje a dividir">
          <button onclick="aplicarPorcentajeComun()" class="btn-aplicar">Porcentaje a dividir</button>
        </div>
        <div class="control-group">
          <button onclick="resetearTodosLosEstudiantes()" class="btn-reset" style="background: #e53e3e; color: white;">🔄 Resetear Todos</button>
        </div>
      </div>

      <div id="sections-container">
        <!-- Las secciones se agregarán aquí dinámicamente -->
      </div>

      <div class="multi-results">
        <div id="multi-result-panel" class="result-panel">
          <div id="multi-result-title">Promedio General</div>
          <div id="multi-result-value">0.00</div>
          <div id="multi-result-status">-</div>
        </div>
        <button id="calcMultiBtn" onclick="calculateMultipleAverages()">Calcular Promedios</button>
      </div>
    </div>
  </div>





  <!-- Panel de Rúbricas -->
  <div id="rubricas-panel" class="panel" style="display: none;">
    <div class="container">
      <h2>Rúbricas Escolares</h2>
      
      <!-- Tabs para modo normal y modo rúbrica - Posición fija -->
      <div class="rubricas-tabs-container">
        <div class="rubricas-tabs">
          <button id="tab-normal" class="tab-button active" data-tab="normal">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <line x1="10" y1="9" x2="8" y2="9"></line>
            </svg>
            Modo Edición
          </button>
          <button id="tab-evaluacion" class="tab-button" data-tab="evaluacion">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 12l2 2 4-4"></path>
              <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"></path>
              <path d="M3 12c1 0-3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"></path>
              <path d="M3 12v9a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-9"></path>
            </svg>
            Modo Evaluación
          </button>
        </div>
      </div>
      
      <!-- Botones de control para modo edición -->
      <div class="rubricas-controls">
        <button type="button" id="nueva-rubrica" class="btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          Nueva Rúbrica
          </button>
        <button type="button" id="cargar-rubrica" class="btn-secondary">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Cargar Rúbrica
          </button>
        </div>

      <!-- Contenido principal de la rúbrica -->
      <div id="rubrica-content" class="rubrica-content">
        <!-- Aquí se mostrará el formulario de nueva rúbrica o la rúbrica cargada -->
      </div>
      
      <!-- Panel de evaluación -->
      <div id="evaluacion-panel" class="evaluacion-panel" style="display: none;">
        <div class="evaluacion-controls">
          <div class="estudiante-selection">
            <div class="form-group">
              <label for="eval-curso-select">Curso</label>
              <select id="eval-curso-select" required>
                <option value="">Seleccionar curso...</option>
              </select>
            </div>
            <div class="form-group">
              <label for="eval-estudiante-select">Estudiante</label>
              <select id="eval-estudiante-select" required disabled>
                <option value="">Seleccionar estudiante...</option>
              </select>
            </div>
            <div class="form-group">
              <label for="eval-rubrica-select">Rúbrica</label>
              <select id="eval-rubrica-select" required disabled>
                <option value="">Seleccionar rúbrica...</option>
              </select>
            </div>
          </div>
          <div class="evaluacion-actions">
            <button type="button" id="iniciar-evaluacion" class="btn-primary">Iniciar Evaluación</button>
            <button type="button" id="cargar-rubrica-evaluacion" class="btn-secondary">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <line x1="10" y1="9" x2="8" y2="9"></line>
              </svg>
              Ver Rúbrica
            </button>
            <button type="button" id="guardar-evaluacion" class="btn-success" style="display: none;">Guardar Evaluación</button>
            <button type="button" id="limpiar-evaluacion" class="btn-danger" style="display: none;">Limpiar</button>
          </div>
        </div>
        <div id="evaluacion-resultado" class="evaluacion-resultado" style="display: none;">
          <!-- Aquí se mostrará el resultado de la evaluación -->
            </div>
      </div>
    </div>
  </div>

  <!-- Panel de Temas Visuales - ELIMINADO -->

  <!-- Panel de Inicio -->
  <div id="config" class="panel" style="display:none;">
    <div class="container">
      <h2>Inicio</h2>
      
      <!-- Contenedor horizontal para las secciones -->
      <div class="config-sections-container">
          <!-- Sección de Gestión de Cursos - Izquierda -->
          <div class="config-section">
              <h3>Gestión de Cursos</h3>
              
              <div class="config-controls">
                  <button id="btn-cargar-excel-config" class="btn-primary" type="button">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                          <polyline points="14 2 14 8 20 8"></polyline>
                          <line x1="12" y1="18" x2="12" y2="12"></line>
                          <line x1="9" y1="15" x2="15" y2="15"></line>
                      </svg>
                      Cargar Lista de Estudiantes
                  </button>
                  
                  <button id="btn-descargar-plantilla-config" class="btn-secondary" type="button">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                          <polyline points="7 10 12 15 17 10"></polyline>
                          <line x1="12" y1="15" x2="12" y2="3"></line>
                      </svg>
                      Descargar Plantilla Excel
                  </button>
              </div>

              <div class="cursos-list">
                  <h4>Cursos Cargados</h4>
                  <div id="lista-cursos" class="lista-cursos">
                      <!-- Los cursos se cargarán dinámicamente aquí -->
                  </div>
                  
                  <!-- Panel para mostrar estudiantes del curso seleccionado -->
                  <div id="estudiantes-panel" class="estudiantes-panel" style="display: none;">
                      <h4 id="curso-seleccionado-titulo">Estudiantes del curso</h4>
                      <div class="estudiantes-header">
                          <span class="estudiantes-count" id="estudiantes-count">0 estudiantes</span>
                          <button id="cerrar-estudiantes" class="btn-cerrar">✕</button>
                      </div>
                      <div id="lista-estudiantes" class="lista-estudiantes">
                          <!-- Los estudiantes se mostrarán aquí -->
                      </div>
                  </div>
              </div>
          </div>

          <!-- Sección de Gestión de Rúbricas - Derecha -->
          <div class="config-section">
              <h3>Gestión de Rúbricas</h3>
              
              <div class="config-controls">
                  <button id="btn-cargar-rubrica-config" class="btn-primary" type="button">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                          <polyline points="14 2 14 8 20 8"></polyline>
                          <line x1="12" y1="18" x2="12" y2="12"></line>
                          <line x1="9" y1="15" x2="15" y2="15"></line>
                      </svg>
                      Cargar Rúbrica desde Archivo
                  </button>
                  
                  <button id="btn-descargar-plantilla-rubrica" class="btn-secondary" type="button">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                          <polyline points="7 10 12 15 17 10"></polyline>
                          <line x1="12" y1="15" x2="12" y2="3"></line>
                      </svg>
                      Descargar Plantilla Rúbrica
                  </button>
              </div>

              <div class="rubricas-list">
                  <h4>Rúbricas Guardadas</h4>
                  <div id="lista-rubricas" class="lista-rubricas">
                      <!-- Las rúbricas se cargarán dinámicamente aquí -->
                  </div>
              </div>
          </div>
      </div>
    </div>
  </div>

  <!-- Panel independiente para mostrar estudiantes del curso -->
  <div id="estudiantes-sidebar" class="estudiantes-sidebar">
    <div class="estudiantes-sidebar-content">
        <div class="estudiantes-sidebar-header">
            <h3 id="estudiantes-sidebar-titulo">Estudiantes del curso</h3>
            <button id="cerrar-estudiantes-sidebar" class="btn-cerrar-sidebar">✕</button>
        </div>
        <div class="estudiantes-sidebar-info">
            <span id="estudiantes-sidebar-count">0 estudiantes</span>
        </div>
        <div id="estudiantes-sidebar-lista" class="estudiantes-sidebar-lista">
            <!-- Los estudiantes se mostrarán aquí -->
        </div>
    </div>
  </div>
  <!-- <script src="themes-editor.js"></script> - ELIMINADO -->

  
  <!-- Dashboard JavaScript - DEBE IR AL FINAL -->
  <script src="dashboard.js"></script>






  
  <!-- Script de inicialización de temas para el dashboard principal -->
  <script>
    // Aplicar tema inmediatamente al cargar
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'theme-dark';
      console.log('🎨 Aplicando tema al dashboard principal:', savedTheme);
      document.body.className = savedTheme;
      
      // Asegurar que el scroll funcione correctamente
      document.body.style.overflowX = 'hidden';
      console.log('✅ Scroll configurado correctamente');
    })();

    // Inicializar fondos animados cuando esté listo
    document.addEventListener('DOMContentLoaded', () => {
      // Inicializar fondos animados
      if (window.animatedBackgrounds) {
        const savedTheme = localStorage.getItem('theme') || 'theme-dark';
        setTimeout(() => {
          window.animatedBackgrounds.switchTheme(savedTheme);
          console.log('✅ Fondos animados inicializados en dashboard principal');
        }, 100);
      }
      
      // Inicializar sistema de créditos
      initializeCreditsSystem();
    });

    // Listener para cambios de tema desde otras ventanas
    window.addEventListener('storage', (e) => {
      if (e.key === 'theme') {
        console.log('🔄 Tema cambiado en dashboard principal:', e.newValue);
        document.body.className = e.newValue;
        if (window.animatedBackgrounds && window.animatedBackgrounds.isInitialized) {
          window.animatedBackgrounds.switchTheme(e.newValue);
        }
      }
    });

    // Listener para cambios de tema en la misma ventana (desde el editor de temas)
    let lastTheme = localStorage.getItem('theme');
    setInterval(() => {
      const currentTheme = localStorage.getItem('theme');
      if (currentTheme !== lastTheme) {
        console.log('🔄 Tema cambiado en la misma ventana del dashboard:', currentTheme);
        lastTheme = currentTheme;
        document.body.className = currentTheme;
        if (window.animatedBackgrounds && window.animatedBackgrounds.isInitialized) {
          window.animatedBackgrounds.switchTheme(currentTheme);
        }
      }
    }, 500);

    // ========================================
    // FUNCIONALIDAD DEL BOTÓN DE CRÉDITOS
    // ========================================
    
    function initializeCreditsSystem() {
      // Elementos del modal de créditos
      const creditsBtn = document.getElementById('credits-btn');
      const creditsModal = document.getElementById('credits-modal');
      const creditsClose = document.querySelector('.credits-close');

      // Verificar que todos los elementos existan
      if (!creditsBtn) {
        console.warn('⚠️ Botón de créditos no encontrado');
        return;
      }
      if (!creditsModal) {
        console.warn('⚠️ Modal de créditos no encontrado');
        return;
      }
      if (!creditsClose) {
        console.warn('⚠️ Botón de cerrar créditos no encontrado');
        return;
      }

      // Cerrar modal de créditos
      function closeCreditsModal() {
        creditsModal.classList.remove('show');
        // Restaurar scroll normal - solo configurar overflow horizontal
        document.body.style.overflowX = 'hidden';
      }

      // Abrir modal de créditos
      creditsBtn.addEventListener('click', () => {
        creditsModal.classList.add('show');
        // Solo prevenir scroll horizontal
        document.body.style.overflowX = 'hidden';
      });

      // Event listeners para cerrar el modal
      creditsClose.addEventListener('click', closeCreditsModal);
      
      // Cerrar al hacer clic fuera del contenido
      creditsModal.addEventListener('click', (e) => {
        if (e.target === creditsModal) {
          closeCreditsModal();
        }
      });

      // Cerrar con tecla Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && creditsModal.classList.contains('show')) {
          closeCreditsModal();
        }
      });

      console.log('✅ Sistema de créditos inicializado correctamente');
    }
  </script>



  <!-- Modal de Créditos -->
  <div id="credits-modal" class="credits-modal">
    <div class="credits-content">
      <div class="credits-header">
        <h3>Créditos y Licencias</h3>
        <button class="credits-close">&times;</button>
      </div>
      <div class="credits-body">
        <div class="credits-section">
          <h4>🎨 Fondos Animados</h4>
          <ul>
            <li><strong>Tema Neon:</strong> Vanta.js HALO Effect - <a href="https://www.vantajs.com/" target="_blank">vantajs.com</a></li>
            <li><strong>Tema Light:</strong> Ocean Waves SVG - <a href="https://s3-us-west-2.amazonaws.com/s.cdpn.io/85486/wave.svg" target="_blank">CodePen Assets</a></li>
            <li><strong>Tema PS2:</strong> Efectos CSS 3D personalizados</li>
            <li><strong>Tema XMB:</strong> Gradientes CSS inspirados en PlayStation 3</li>
          </ul>
        </div>
        
        <div class="credits-section">
          <h4>📚 Librerías y Dependencias</h4>
          <ul>
            <li><strong>Three.js:</strong> <a href="https://threejs.org/" target="_blank">threejs.org</a> - MIT License</li>
            <li><strong>Vanta.js:</strong> <a href="https://www.vantajs.com/" target="_blank">vantajs.com</a> - MIT License</li>
            <li><strong>Supabase:</strong> <a href="https://supabase.com/" target="_blank">supabase.com</a> - Apache 2.0 License</li>
          </ul>
        </div>
        
        <div class="credits-section">
          <h4>🎯 Recursos Externos</h4>
          <ul>
            <li><strong>Iconos:</strong> Emojis Unicode estándar</li>
            <li><strong>Fuentes:</strong> Fuentes del sistema</li>
            <li><strong>SVG Waves:</strong> Recursos de CodePen bajo licencia libre</li>
          </ul>
        </div>
        
        <div class="credits-section">
          <h4>⚖️ Licencias</h4>
          <p><strong>NinjPro:</strong> Proyecto educativo desarrollado con fines académicos.</p>
          <p>Todas las librerías externas mantienen sus licencias originales.</p>
          <p>Los efectos visuales personalizados están disponibles bajo licencia MIT.</p>
        </div>
        
        <div class="credits-footer">
          <p>💻 Desarrollado con ❤️ para la educación</p>
          <p><small>Versión 2024 - Sistema de Fondos Animados</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Panel de Matemáticas Rápidas -->
  <div id="matematicas-rapidas-panel" style="display: none;">
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="title">🧠 Matemáticas Rápidas</h1>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <div class="calculator-container">
            <!-- Game Setup Panel -->
            <div class="setup-panel" id="math-setup-panel">
                <div class="calculator-display config-text">
                    Configurar Juego
                </div>
                
                <div class="game-setup">
                    <div class="config-item">
                        <label class="config-label" for="math-num-count">Cantidad de números:</label>
                        <input type="range" id="math-num-count" min="3" max="15" value="5" class="config-slider">
                        <span class="slider-value" id="math-num-count-display">5</span>
                    </div>

                    <div class="config-item">
                        <label class="config-label" for="math-interval">Intervalo (segundos):</label>
                        <input type="range" id="math-interval" min="1" max="10" value="3" class="config-slider">
                        <span class="slider-value" id="math-interval-display">3</span>
                    </div>

                    <div class="config-item">
                        <label class="config-label">Rango de números:</label>
                        <div class="calculator-grid">
                            <input type="number" id="math-min-number" value="1" min="-100" max="100" placeholder="Mín" class="config-input">
                            <input type="number" id="math-max-number" value="50" min="-100" max="100" placeholder="Máx" class="config-input">
                        </div>
                    </div>

                    <div class="checkbox-container">
                        <div class="custom-checkbox" id="math-checkbox">
                            <span style="display: none;">✓</span>
                        </div>
                        <input type="checkbox" id="math-include-negatives" style="display: none;">
                        <label class="config-label" for="math-include-negatives">Incluir números negativos</label>
                    </div>

                    <div class="checkbox-container">
                        <div class="custom-checkbox" id="math-sound-checkbox">
                            <span style="display: none;">✓</span>
                        </div>
                        <input type="checkbox" id="math-sound-enabled" checked style="display: none;">
                        <label class="config-label" for="math-sound-enabled">🔊 Sonidos activados</label>
                    </div>
                </div>

                <div class="calculator-grid">
                    <button class="calc-button primary" id="math-start-btn">�� Comenzar</button>
                </div>
            </div>

            <!-- Game Panel -->
            <div class="game-panel" id="math-game-panel" style="display: none;">
                <div class="calculator-display" id="math-display-number">0</div>
                
                <div class="game-display">
                    <div class="game-progress">
                        <div class="progress-fill" id="math-progress-fill"></div>
                    </div>
                    <div class="game-stats">
                        <span>Número: <span id="math-current-number">1</span>/<span id="math-total-numbers">5</span></span>
                        <span>Tiempo: <span id="math-countdown">3</span>s</span>
                    </div>
                    <p style="text-align: center; margin: 1rem 0; color: var(--calc-text-light);">Suma mentalmente este número</p>
                </div>

                <div class="calculator-grid">
                    <button class="calc-button warning" id="math-pause-btn">⏸️ Pausar</button>
                    <button class="calc-button danger" id="math-stop-btn">⏹️ Detener</button>
                </div>
            </div>

            <!-- Results Panel -->
            <div class="results-panel" id="math-results-panel" style="display: none;">
                <div class="calculator-display config-text">
                    📊 Resultados
                </div>
                
                <div class="result-summary">
                    <h3 style="margin-bottom: 1rem; color: var(--calc-text);">Números mostrados:</h3>
                    <div class="numbers-grid" id="math-numbers-list"></div>
                </div>

                <div style="margin: 1.5rem 0;">
                    <div style="background: var(--calc-border); padding: 1rem; border-radius: var(--calc-radius); text-align: center; margin-bottom: 1rem;">
                        <span id="math-calculation-display" style="color: var(--calc-text); font-weight: 600;">Cálculo</span>
                    </div>
                    
                    <input type="number" id="math-user-answer" placeholder="Tu respuesta" class="answer-input">
                    
                    <div id="math-result-display" style="display: none; text-align: center; margin: 1rem 0; padding: 1rem; border-radius: var(--calc-radius); background: var(--calc-border);">
                        <div style="margin-bottom: 0.5rem;">
                            <span>Respuesta correcta: <strong id="math-correct-answer">0</strong></span>
                        </div>
                        <div id="math-result-status" style="font-weight: 600;"></div>
                    </div>
                </div>

                <div class="calculator-grid">
                    <button class="calc-button success" id="math-reveal-btn">🎯 Revelar</button>
                    <button class="calc-button primary" id="math-play-again-btn">🔄 De Nuevo</button>
                </div>
                
                <button class="calc-button" id="math-new-config-btn" style="width: 100%; margin-top: 1rem;">⚙️ Nueva Configuración</button>
            </div>

            <!-- Pause Overlay -->
            <div class="pause-overlay" id="math-pause-overlay" style="display: none;">
                <div class="pause-card">
                    <h2 style="margin-bottom: 1rem; color: var(--calc-text);">⏸️ Pausado</h2>
                    <p style="margin-bottom: 1.5rem; color: var(--calc-text-light);">El juego está pausado. Presiona continuar cuando estés listo.</p>
                    <button class="calc-button success" id="math-resume-btn">▶️ Continuar</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2024 ProfeNinja - Matemáticas Rápidas</p>
    </footer>

    <!-- Fondos animados para matemáticas rápidas -->
    <div id="bg-wrap-math" class="bg-wrap"></div>
    <div id="bg-wrap-dark-math" class="bg-wrap-dark"></div>
    <div id="bg-wrap-rosa-math" class="bg-wrap-rosa"></div>
    <div id="bg-wrap-neon-math" class="bg-wrap-neon"></div>
  </div>

  <!-- Barra de Carga Global -->
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <h3 class="loading-text" id="loading-text">Cargando aplicación...</h3>
      <p class="loading-subtext" id="loading-subtext">Por favor espera un momento</p>
      <div class="loading-progress">
        <div class="loading-progress-bar" id="loading-progress-bar"></div>
      </div>
    </div>
  </div>

</body>
</html>

